# System Architecture - Visual Guide

## High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TRAFFIC VIOLATION SYSTEM                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TrafficSensorâ”‚  Generates batches of vehicles (10-15 cars)
â”‚  (3s intervalâ”‚  Every 3 seconds
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    QueuedCarProcessor (Main Engine)      â”‚
â”‚   â”œâ”€ Add vehicles to queue               â”‚
â”‚   â”œâ”€ Manage 5 concurrent workers         â”‚
â”‚   â”œâ”€ Emit callbacks                      â”‚
â”‚   â””â”€ Track statistics                    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                     â”‚
       â†“                                     â†“
   [Queue]                          [5 Worker Threads]
  10-15 Cars    â—„â”€ Pull cars â”€â”€â”€â”€â–º    Each checks a car
                                     in parallel
       â”‚                                     â”‚
       â”‚                                     â†“
       â”‚                            [Check Individual Car]
       â”‚                            â”œâ”€ Speed check
       â”‚                            â”œâ”€ Calculate fine
       â”‚                            â””â”€ Return verdict
       â”‚                                     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
     [Return Verdict Callbacks]
     [SAFE] or [VIOLATION] with fine
              â”‚
              â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Output Channels    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ 1. Console logs     â”‚ [CHECK], [SAFE], [VIOLATION]
     â”‚ 2. GUI Display      â”‚ Real-time status panel
     â”‚ 3. Data files       â”‚ traffic_data.json, tickets.json
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

```
SENSOR                PROCESSOR                 RESULTS
  â”‚                      â”‚                        â”‚
  â”œâ”€ Car 1               â”‚                        â”‚
  â”œâ”€ Car 2               â”‚                        â”‚
  â”œâ”€ Car 3         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”œâ”€ Car 4         â”‚ QueuedCarProcessor     â”‚    â”‚
  â”œâ”€ Car 5    â”€â”€â”€â”€â–ºâ”‚                        â”‚    â”‚
  â”œâ”€ Car 6         â”‚  Queue [5 Cars]        â”‚    â”‚
  â”œâ”€ Car 7         â”‚                        â”‚    â”‚
  â”œâ”€ Car 8    Add  â”‚  Worker 1 â†’ Car 1 â”€â”€â”€â”€â”¤â”€â”€â”€â”€â–º [SAFE]
  â”œâ”€ Car 9         â”‚  Worker 2 â†’ Car 2 â”€â”€â”€â”€â”¤â”€â”€â”€â”€â–º [VIOLATION] $50
  â”œâ”€ Car 10        â”‚  Worker 3 â†’ Car 3 â”€â”€â”€â”€â”¤â”€â”€â”€â”€â–º [SAFE]
  â”‚                â”‚  Worker 4 â†’ Car 4 â”€â”€â”€â”€â”¤â”€â”€â”€â”€â–º [VIOLATION] $30
  â”‚ (more...)      â”‚  Worker 5 â†’ Car 5 â”€â”€â”€â”€â”¤â”€â”€â”€â”€â–º [SAFE]
  â”‚                â”‚                        â”‚
  â”‚                â”‚  After 100-200ms       â”‚
  â”‚                â”‚  Workers get next cars â”‚
  â”‚                â”‚                        â”‚
  â”‚                â”‚  Car 6 â†’ [VIOLATION]   â”‚â”€â”€â”€â”€â–º $75
  â”‚                â”‚  Car 7 â†’ [SAFE]        â”‚â”€â”€â”€â”€â–º OK
  â”‚                â”‚  ...continues...       â”‚
  â”‚                â”‚                        â”‚
  â”‚                â”‚  [COMPLETE BATCH]      â”‚â”€â”€â”€â”€â–º Signal
  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Concurrent Processing Timeline

```
TIME PROGRESS
 â†“

 0ms   [Batch arrives: 10 cars]
       â””â”€ Add to queue

 10ms  [Workers start]
       Worker 1: Car 1 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (100-200ms)
       Worker 2: Car 2 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
       Worker 3: Car 3 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
       Worker 4: Car 4 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
       Worker 5: Car 5 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

110ms  Car 1 complete â†’ [SAFE]
       Worker 1: Car 6 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

120ms  Car 2 complete â†’ [VIOLATION] $50
       Worker 2: Car 7 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

130ms  Car 3 complete â†’ [SAFE]
       Worker 3: Car 8 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

140ms  Car 4 complete â†’ [VIOLATION] $30
       Worker 4: Car 9 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

150ms  Car 5 complete â†’ [SAFE]
       Worker 5: Car 10 â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

...

300ms  Car 10 complete â†’ [VIOLATION] $60

       [BATCH COMPLETE] - 10 cars done, 4 violations
       Average time: ~30ms per car (with parallelism)
```

---

## Class Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  QueuedCarProcessor              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Properties:                      â”‚
â”‚  - car_queue: Queue              â”‚
â”‚  - executor: ThreadPoolExecutor  â”‚
â”‚  - num_workers: 5                â”‚
â”‚  - total_processed: int          â”‚
â”‚  - total_violations: int         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Methods:                         â”‚
â”‚  - start()                       â”‚
â”‚  - stop()                        â”‚
â”‚  - add_vehicles(list)            â”‚
â”‚  - _main_loop()                  â”‚
â”‚  - _check_car(vehicle)           â”‚
â”‚  - get_stats()                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Callbacks:                       â”‚
â”‚  - on_car_checking()             â”‚
â”‚  - on_car_checked()              â”‚
â”‚  - on_batch_complete()           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–³
                 â”‚
                 â”‚
         Uses â”€â”€â”€â”´â”€â”€â–º CarCheckResult
                         â”œâ”€ vehicle
                         â”œâ”€ is_violation
                         â”œâ”€ violation_type
                         â”œâ”€ ticket
                         â””â”€ check_timestamp
```

---

## GUI Display Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Traffic Simulation GUI                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LEFT PANEL       â”‚  â”‚ RIGHT PANEL              â”‚ â”‚
â”‚ â”‚ (Controls)       â”‚  â”‚ (Violations Table)       â”‚ â”‚
â”‚ â”‚                  â”‚  â”‚                          â”‚ â”‚
â”‚ â”‚ [Mulai]  [Stop]  â”‚  â”‚ Plat â”‚ Pemilik â”‚ Denda  â”‚ â”‚
â”‚ â”‚ [Clear]          â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚                  â”‚  â”‚ ABC..â”‚ John Doeâ”‚ 775K... â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ XYZ..â”‚ Jane D. â”‚ 620K... â”‚ â”‚
â”‚ â”‚ â”‚ Statistics   â”‚ â”‚  â”‚                          â”‚ â”‚
â”‚ â”‚ â”‚              â”‚ â”‚  â”‚                          â”‚ â”‚
â”‚ â”‚ â”‚ Violations:0 â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ â”‚ Vehicles: 10 â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚ Denda: 0Rp   â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚              â”‚ â”‚                                â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                â”‚
â”‚ â”‚                  â”‚                                â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                â”‚
â”‚ â”‚ â”‚[CHECK] Statusâ”‚ â”‚                                â”‚
â”‚ â”‚ â”‚              â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚ Plat: ABC124 â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚ Owner: John  â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚ Speed: 85km  â”‚ â”‚                                â”‚
â”‚ â”‚ â”‚ Status: VIOL â”‚ â”‚  â–²                            â”‚
â”‚ â”‚ â”‚              â”‚ â”‚  â”‚ Auto-refresh               â”‚
â”‚ â”‚ â”‚[QUEUE]Status:â”‚ â”‚  â”‚ every 500ms                â”‚
â”‚ â”‚ â”‚ 3 waiting    â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚              â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚[RESULT]Last: â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚ VIOLATION    â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚ Fine: 775Rp  â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚              â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚[INFO]5 sensorsâ”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â”‚ concurrent   â”‚ â”‚  â”‚                            â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                â”‚
â”‚ â”‚                  â”‚                                â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Processing States

```
                    START
                      â”‚
                      â†“
            [Waiting for Vehicles]
                      â”‚
        Vehicles added to queue
                      â”‚
                      â†“
            [Processing Queue]
         (5 workers active)
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“             â†“             â†“
    [Worker 1]   [Worker 2]   [Worker 3...]
      Check       Check         Check
      Car 1       Car 2         Car 3
        â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
              [Results Ready]
        [SAFE] or [VIOLATION]
                      â”‚
                      â†“
            [Callback Emitted]
              on_car_checked
                      â”‚
                      â†“
       [Workers get next cars]
       OR [Queue empty]
                      â”‚
                      â†“
            [Batch Complete]
            on_batch_complete
                      â”‚
                      â†“
            [Waiting for next batch]
```

---

## Callback Flow

```
QueuedCarProcessor                     Callbacks
     â”‚                                     â”‚
     â”œâ”€ on_car_checking(vehicle)          â”‚
     â”‚  â””â”€ Called when checking startsâ”€â”€â”€â”€â–º logger.info("[CHECK]...")
     â”‚                                     gui.current_vehicle_label
     â”‚
     â”œâ”€ on_car_checked(result)            â”‚
     â”‚  â””â”€ Called with verdict â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º logger.warning("[VIOLATION]")
     â”‚                                     logger.info("[SAFE]")
     â”‚                                     gui.last_verdict_label
     â”‚
     â””â”€ on_batch_complete(vehicles, violations)
        â””â”€ Called when batch done â”€â”€â”€â”€â”€â”€â–º logger.info("[COMPLETE]")
                                          gui.refresh_violations_table
```

---

## Real-time GUI Update Cycle

```
AUTO_REFRESH Timer (every 500ms)
     â”‚
     â”œâ”€ Read traffic_data.json
     â”œâ”€ Read tickets.json
     â”‚
     â”œâ”€ Update violation count
     â”œâ”€ Update vehicle count
     â”‚
     â”œâ”€ Show current car (last in vehicles)
     â”œâ”€ Calculate queue size (vehicles - violations)
     â”œâ”€ Show last verdict
     â”‚
     â”œâ”€ Update statistics:
     â”‚  â”œâ”€ Total violations
     â”‚  â”œâ”€ Total fines (IDR)
     â”‚  â”œâ”€ Avg speed
     â”‚  â””â”€ Max speed
     â”‚
     â””â”€ Refresh violations table
        â””â”€ Show top violations
```

---

## Performance Characteristics

```
Sequential Processing:
  Car 1: â–“ [SAFE]
  Car 2: â–“ [VIOLATION]
  Car 3: â–“ [SAFE]
  Time: ~300ms per car

Concurrent Processing (5 workers):
  Cars 1-5 in parallel
  Car 1:  â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
  Car 2:  â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
  Car 3:  â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
  Car 4:  â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
  Car 5:  â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
  Time: ~300ms for 5 cars = 60ms per car (5x faster!)
```

---

This completes the smooth sequential car processing implementation! ğŸ‰
